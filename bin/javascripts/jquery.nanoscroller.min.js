(function(d,i,j){var k,h,l,m;l={paneClass:"pane",sliderClass:"slider",contentClass:"content",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null};k="Microsoft Internet Explorer"===i.navigator.appName&&/msie 7./i.test(i.navigator.appVersion)&&i.ActiveXObject;h=null;m=function(){var a,b;a=j.createElement("div");b=a.style;b.position="absolute";b.width="100px";b.height="100px";b.overflow="scroll";b.top="-9999px";j.body.appendChild(a);
b=a.offsetWidth-a.clientWidth;j.body.removeChild(a);return b};var c=function(a,b){this.el=a;this.options=b;h||(h=m());this.$el=d(this.el);this.doc=d(j);this.win=d(i);this.generate();this.createEvents();this.addEvents();this.reset()};c.prototype.preventScrolling=function(a,b){this.isActive&&("DOMMouseScroll"===a.type?("down"===b&&0<a.originalEvent.detail||"up"===b&&0>a.originalEvent.detail)&&a.preventDefault():"mousewheel"===a.type&&a.originalEvent&&a.originalEvent.wheelDelta&&("down"===b&&0>a.originalEvent.wheelDelta||
"up"===b&&0<a.originalEvent.wheelDelta)&&a.preventDefault())};c.prototype.updateScrollValues=function(){var a;a=this.content;this.maxScrollTop=a.scrollHeight-a.clientHeight;this.contentScrollTop=a.scrollTop;this.maxSliderTop=this.paneHeight-this.sliderHeight;this.sliderTop=this.contentScrollTop*this.maxSliderTop/this.maxScrollTop};c.prototype.createEvents=function(){var a=this;this.events={down:function(b){a.isBeingDragged=!0;a.offsetY=b.pageY-a.slider.offset().top;a.pane.addClass("active");a.doc.bind("mousemove",
a.events.drag).bind("mouseup",a.events.up);return!1},drag:function(b){a.sliderY=b.pageY-a.$el.offset().top-a.offsetY;a.scroll();a.updateScrollValues();a.contentScrollTop>=a.maxScrollTop?a.$el.trigger("scrollend"):0===a.contentScrollTop&&a.$el.trigger("scrolltop");return!1},up:function(){a.isBeingDragged=!1;a.pane.removeClass("active");a.doc.unbind("mousemove",a.events.drag).unbind("mouseup",a.events.up);return!1},resize:function(){a.reset()},panedown:function(b){a.sliderY=(b.offsetY||b.originalEvent.layerY)-
0.5*a.sliderHeight;a.scroll();a.events.down(b);return!1},scroll:function(b){a.isBeingDragged||(a.updateScrollValues(),a.sliderY=a.sliderTop,a.slider.css({top:a.sliderTop}),null!=b&&(a.contentScrollTop>=a.maxScrollTop?(a.options.preventPageScrolling&&a.preventScrolling(b,"down"),a.$el.trigger("scrollend")):0===a.contentScrollTop&&(a.options.preventPageScrolling&&a.preventScrolling(b,"up"),a.$el.trigger("scrolltop"))))},wheel:function(b){if(null!=b)return a.sliderY+=-b.wheelDeltaY||-b.delta,a.scroll(),
!1}}};c.prototype.addEvents=function(){var a;this.removeEvents();a=this.events;this.options.disableResize||this.win.bind("resize",a.resize);this.slider.bind("mousedown",a.down);this.pane.bind("mousedown",a.panedown).bind("mousewheel DOMMouseScroll",a.wheel);this.$content.bind("scroll mousewheel DOMMouseScroll touchmove",a.scroll)};c.prototype.removeEvents=function(){var a;a=this.events;this.win.unbind("resize",a.resize);this.slider.unbind();this.pane.unbind();this.$content.unbind("scroll mousewheel DOMMouseScroll touchmove",
a.scroll)};c.prototype.generate=function(){var a,b,c,g,e;c=this.options;g=c.paneClass;e=c.sliderClass;a=c.contentClass;!this.$el.find(""+g).length&&!this.$el.find(""+e).length&&this.$el.append('<div class="'+g+'"><div class="'+e+'" /></div>');this.$content=this.$el.children("."+a);this.$content.attr("tabindex",0);this.content=this.$content[0];this.slider=this.$el.find("."+e);this.pane=this.$el.find("."+g);h&&(b={right:-h},this.$el.addClass("has-scrollbar"));c.iOSNativeScrolling&&(b||(b={}),b.WebkitOverflowScrolling=
"touch");null!=b&&this.$content.css(b);return this};c.prototype.restore=function(){this.stopped=!1;this.pane.show();return this.addEvents()};c.prototype.reset=function(){var a,b,c,g,e,d,f;this.$el.find("."+this.options.paneClass).length||this.generate().stop();this.stopped&&this.restore();a=this.content;c=a.style;g=c.overflowY;k&&this.$content.css({height:this.$content.height()});b=a.scrollHeight+h;d=this.pane.outerHeight();f=parseInt(this.pane.css("top"),10);e=parseInt(this.pane.css("bottom"),10);
e=d+f+e;f=Math.round(e/b*e);f<this.options.sliderMinHeight?f=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&f>this.options.sliderMaxHeight&&(f=this.options.sliderMaxHeight);"scroll"===g&&"scroll"!==c.overflowX&&(f+=h);this.maxSliderTop=e-f;this.contentHeight=b;this.paneHeight=d;this.paneOuterHeight=e;this.sliderHeight=f;this.slider.height(f);this.events.scroll();this.pane.show();this.isActive=!0;a.scrollHeight===a.clientHeight||this.pane.outerHeight(!0)>=a.scrollHeight&&"scroll"!==
g?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===a.scrollHeight&&"scroll"===g?this.slider.hide():this.slider.show();this.options.alwaysVisible?this.pane.css({opacity:1,visibility:"visible"}):this.pane.css({opacity:"",visibility:""});return this};c.prototype.scroll=function(){this.sliderY=Math.max(0,this.sliderY);this.sliderY=Math.min(this.maxSliderTop,this.sliderY);this.$content.scrollTop(-1*((this.paneHeight-this.contentHeight+h)*this.sliderY/this.maxSliderTop));this.slider.css({top:this.sliderY});
return this};c.prototype.scrollBottom=function(a){this.reset();this.$content.scrollTop(this.contentHeight-this.$content.height()-a).trigger("mousewheel");return this};c.prototype.scrollTop=function(a){this.reset();this.$content.scrollTop(+a).trigger("mousewheel");return this};c.prototype.scrollTo=function(a){this.reset();a=d(a).offset().top;a>this.maxSliderTop&&(a/=this.contentHeight,this.sliderY=a*=this.maxSliderTop,this.scroll());return this};c.prototype.stop=function(){this.stopped=!0;this.removeEvents();
this.pane.hide();return this};c.prototype.flash=function(){var a=this;this.reset();this.pane.addClass("flashed");setTimeout(function(){a.pane.removeClass("flashed")},this.options.flashDelay);return this};d.fn.nanoScroller=function(a){return this.each(function(){var b;if(!(b=this.nanoscroller))b=d.extend({},l,a),this.nanoscroller=b=new c(this,b);if(a&&"object"===typeof a){d.extend(b.options,a);if(a.scrollBottom)return b.scrollBottom(a.scrollBottom);if(a.scrollTop)return b.scrollTop(a.scrollTop);if(a.scrollTo)return b.scrollTo(a.scrollTo);
if("bottom"===a.scroll)return b.scrollBottom(0);if("top"===a.scroll)return b.scrollTop(0);if(a.scroll&&a.scroll instanceof d)return b.scrollTo(a.scroll);if(a.stop)return b.stop();if(a.flash)return b.flash()}return b.reset()})}})(jQuery,window,document);