(function(d,j,k){var m,f,l,n,o,p;o={paneClass:"pane",sliderClass:"slider",sliderMinHeight:20,contentClass:"content",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1};m="Microsoft Internet Explorer"===j.navigator.appName&&/msie 7./i.test(j.navigator.appVersion)&&j.ActiveXObject;f=null;l={};p=function(){var c,a;c=k.createElement("div");a=c.style;a.position="absolute";a.width="100px";a.height="100px";a.overflow="scroll";a.top="-9999px";k.body.appendChild(c);a=c.offsetWidth-
c.clientWidth;k.body.removeChild(c);return a};n=function(){function c(a,b){this.options=b;f||(f=p());this.el=d(a);this.doc=d(k);this.win=d(j);this.generate();this.createEvents();this.addEvents();this.reset()}c.prototype.preventScrolling=function(a,b){"DOMMouseScroll"===a.type?("down"===b&&0<a.originalEvent.detail||"up"===b&&0>a.originalEvent.detail)&&a.preventDefault():"mousewheel"===a.type&&a.originalEvent&&a.originalEvent.wheelDelta&&("down"===b&&0>a.originalEvent.wheelDelta||"up"===b&&0<a.originalEvent.wheelDelta)&&
a.preventDefault()};c.prototype.updateScrollValues=function(){var a;a=this.content[0];this.maxScrollTop=a.scrollHeight-a.clientHeight;this.contentScrollTop=a.scrollTop;this.maxSliderTop=this.paneOuterHeight-this.sliderHeight;this.sliderTop=this.contentScrollTop*this.maxSliderTop/this.maxScrollTop};c.prototype.handleKeyPress=function(a){var b;if(38===a||33===a||40===a||34===a)b=38===a||40===a?40:0.9*this.paneHeight,b=100*(b/(this.contentHeight-this.paneHeight)),b=b*this.maxSliderTop/100,this.sliderY=
38===a||33===a?this.sliderY-b:this.sliderY+b,this.scroll();else if(36===a||35===a)this.sliderY=36===a?0:this.maxSliderTop,this.scroll()};c.prototype.createEvents=function(){var a=this;this.events={down:function(b){a.isBeingDragged=!0;a.offsetY=b.pageY-a.slider.offset().top;a.pane.addClass("active");a.doc.bind("mousemove",a.events.drag).bind("mouseup",a.events.up);return!1},drag:function(b){a.sliderY=b.pageY-a.el.offset().top-a.offsetY;a.scroll();a.updateScrollValues();a.contentScrollTop>=a.maxScrollTop?
a.el.trigger("scrollend"):0===a.contentScrollTop&&a.el.trigger("scrolltop");return!1},up:function(){a.isBeingDragged=!1;a.pane.removeClass("active");a.doc.unbind("mousemove",a.events.drag).unbind("mouseup",a.events.up);return!1},resize:function(){a.reset()},panedown:function(b){a.sliderY=(b.offsetY||b.originalEvent.layerY)-0.5*a.sliderHeight;a.scroll();a.events.down(b);return!1},scroll:function(b){a.isBeingDragged||(a.updateScrollValues(),a.sliderY=a.sliderTop,a.slider.css({top:a.sliderTop}),null!=
b&&(a.contentScrollTop>=a.maxScrollTop?(a.options.preventPageScrolling&&a.preventScrolling(b,"down"),a.el.trigger("scrollend")):0===a.contentScrollTop&&(a.options.preventPageScrolling&&a.preventScrolling(b,"up"),a.el.trigger("scrolltop"))))},wheel:function(b){if(null!=b)return a.sliderY+=-b.wheelDeltaY||-b.delta,a.scroll(),!1},keydown:function(b){var c;if(null!=b&&(c=b.which,38===c||33===c||40===c||34===c||36===c||35===c))a.sliderY=isNaN(a.sliderY)?0:a.sliderY,l[c]=setTimeout(function(){a.handleKeyPress(c)},
100),b.preventDefault()},keyup:function(b){null!=b&&(b=b.which,a.handleKeyPress(b),null!=l[b]&&clearTimeout(l[b]))}}};c.prototype.addEvents=function(){var a;a=this.events;this.options.disableResize||this.win.bind("resize",a.resize);this.slider.bind("mousedown",a.down);this.pane.bind("mousedown",a.panedown).bind("mousewheel",a.wheel).bind("DOMMouseScroll",a.wheel);this.content.bind("mousewheel",a.scroll).bind("DOMMouseScroll",a.scroll).bind("touchmove",a.scroll).bind("keydown",a.keydown).bind("keyup",
a.keyup)};c.prototype.removeEvents=function(){var a;a=this.events;this.options.disableResize||this.win.unbind("resize",a.resize);this.slider.unbind("mousedown",a.down);this.pane.unbind("mousedown",a.panedown).unbind("mousewheel",a.wheel).unbind("DOMMouseScroll",a.wheel);this.content.unbind("mousewheel",a.scroll).unbind("DOMMouseScroll",a.scroll).unbind("touchmove",a.scroll).unbind("keydown",a.keydown).unbind("keyup",a.keyup)};c.prototype.generate=function(){var a,b,c,i,e;c=this.options;i=c.paneClass;
e=c.sliderClass;a=c.contentClass;this.el.append('<div class="'+i+'"><div class="'+e+'" /></div>');this.content=d(this.el.children("."+a)[0]);this.content.attr("tabindex",0);this.slider=this.el.find("."+e);this.pane=this.el.find("."+i);f&&(b={right:-f},this.el.addClass("has-scrollbar"));c.iOSNativeScrolling&&(null==b&&(b={}),b.WebkitOverflowScrolling="touch");null!=b&&this.content.css(b);c.alwaysVisible&&this.pane.css({opacity:1,visibility:"visible"});return this};c.prototype.restore=function(){this.stopped=
!1;this.pane.show();return this.addEvents()};c.prototype.reset=function(){var a,b,c,i,e,d,g;this.el.find("."+this.options.paneClass).length||this.generate().stop();this.stopped&&this.restore();a=this.content[0];c=a.style;i=c.overflowY;m&&this.content.css({height:this.content.height()});b=a.scrollHeight+f;d=this.pane.outerHeight();g=parseInt(this.pane.css("top"),10);e=parseInt(this.pane.css("bottom"),10);e=d+g+e;g=Math.round(e/b*e);g=g>this.options.sliderMinHeight?g:this.options.sliderMinHeight;"scroll"===
i&&"scroll"!==c.overflowX&&(g+=f);this.maxSliderTop=e-g;this.contentHeight=b;this.paneHeight=d;this.paneOuterHeight=e;this.sliderHeight=g;this.slider.height(g);this.events.scroll();this.pane.show();this.paneOuterHeight>=a.scrollHeight&&"scroll"!==i?this.pane.hide():this.el.height()===a.scrollHeight&&"scroll"===i?this.slider.hide():this.slider.show();return this};c.prototype.scroll=function(){this.sliderY=Math.max(0,this.sliderY);this.sliderY=Math.min(this.maxSliderTop,this.sliderY);this.content.scrollTop(-1*
((this.paneHeight-this.contentHeight+f)*this.sliderY/this.maxSliderTop));this.slider.css({top:this.sliderY});return this};c.prototype.scrollBottom=function(a){this.reset();this.content.scrollTop(this.contentHeight-this.content.height()-a).trigger("mousewheel");return this};c.prototype.scrollTop=function(a){this.reset();this.content.scrollTop(+a).trigger("mousewheel");return this};c.prototype.scrollTo=function(a){this.reset();a=d(a).offset().top;a>this.maxSliderTop&&(a/=this.contentHeight,this.sliderY=
a*=this.maxSliderTop,this.scroll());return this};c.prototype.stop=function(){this.stopped=!0;this.removeEvents();this.pane.hide();return this};c.prototype.flash=function(){var a=this;this.pane.addClass("flashed");setTimeout(function(){return a.pane.removeClass("flashed")},1500);return this};return c}();d.fn.nanoScroller=function(c){var a,b,f,i,e,j,g;null!=c&&(i=c.scrollBottom,j=c.scrollTop,e=c.scrollTo,f=c.scroll,g=c.stop,a=c.flash);b=d.extend({},o,c);this.each(function(){var h;if(h=d.data(this,"scrollbar"))d.extend(h.options,
c);else{h=new n(this,b);d.data(this,"scrollbar",h)}return i?h.scrollBottom(i):j?h.scrollTop(j):e?h.scrollTo(e):f==="bottom"?h.scrollBottom(0):f==="top"?h.scrollTop(0):f instanceof d?h.scrollTo(f):g?h.stop():a?h.flash():h.reset()})}})(jQuery,window,document);